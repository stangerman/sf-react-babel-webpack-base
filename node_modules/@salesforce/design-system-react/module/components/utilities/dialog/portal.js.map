{"version":3,"sources":["../../../../.tmp-es/components/utilities/dialog/portal.jsx"],"names":["Component","Children","PropTypes","ReactDOM","Portal","props","portalNode","state","isOpen","renderPortal","unmountPortal","only","children","element","renderTo","document","querySelector","body","parentParentNode","getPortalParentNode","createElement","renderTag","appendChild","portalNodeInstance","onMount","undefined","portal","unmountComponentAtNode","parentNode","removeChild","id","className","style","Object","keys","forEach","key","onUpdate","getChildren","setupPortalNode","portalMount","instance","reactElement","domContainerNode","updateCallback","updatePortal","unstable_renderSubtreeIntoContainer","onOpen","setState","displayName","propTypes","string","any","node","object","func","onUnmount","defaultProps"],"mappings":"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","sourcesContent":["/* Copyright (c) 2015-present, salesforce.com, inc. All rights reserved */\n/* Licensed under BSD 3-Clause - see LICENSE.txt or git.io/sfdc-license */\n\nimport { Component, Children } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\n\n/*\n * This component mounts its children within a disconnected render tree (portal).\n */\nclass Portal extends Component {\n\tconstructor (props) {\n\t\tsuper(props);\n\t\tthis.portalNode = null;\n\t\tthis.state = {\n\t\t\tisOpen: false,\n\t\t};\n\t}\n\n\tcomponentDidMount () {\n\t\tthis.renderPortal();\n\t}\n\n\tcomponentDidUpdate () {\n\t\tthis.renderPortal();\n\t}\n\n\tcomponentWillUnmount () {\n\t\tthis.unmountPortal();\n\t}\n\n\tgetChildren () {\n\t\treturn Children.only(this.props.children);\n\t}\n\n\tgetPortalParentNode () {\n\t\tlet element;\n\t\tif (typeof this.props.renderTo === 'string') {\n\t\t\telement = document.querySelector(this.props.renderTo);\n\t\t} else {\n\t\t\telement = this.props.renderTo || document.body;\n\t\t}\n\t\treturn element;\n\t}\n\n\tsetupPortalNode () {\n\t\tconst parentParentNode = this.getPortalParentNode();\n\n\t\tthis.portalNode = document.createElement(this.props.renderTag);\n\t\tparentParentNode.appendChild(this.portalNode);\n\t\tthis.portalNodeInstance = this.props.onMount\n\t\t\t? this.props.onMount(undefined, { portal: this.portalNode })\n\t\t\t: this.portalNode;\n\t}\n\n\tunmountPortal () {\n\t\tif (this.portalNode) {\n\t\t\tReactDOM.unmountComponentAtNode(this.portalNode);\n\t\t\tthis.portalNode.parentNode.removeChild(this.portalNode);\n\t\t}\n\t\tthis.portalNode = null;\n\t}\n\n\tupdatePortal () {\n\t\tif (this.props.id) {\n\t\t\tthis.portalNode.id = this.props.id;\n\t\t}\n\n\t\tif (this.props.className) {\n\t\t\tthis.portalNode.className = this.props.className;\n\t\t}\n\n\t\tif (this.props.style) {\n\t\t\tObject.keys(this.props.style).forEach((key) => {\n\t\t\t\tthis.portalNode.style[key] = this.props.style[key];\n\t\t\t});\n\t\t}\n\n\t\tif (this.props.onUpdate) {\n\t\t\tthis.portalNodeInstance = this.props.onUpdate(this.portalNodeInstance);\n\t\t}\n\t}\n\n\trenderPortal () {\n\t\t// if no portal contents, then unmount\n\t\tif (!this.getChildren()) {\n\t\t\tthis.unmountPortal();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.portalNode) {\n\t\t\tthis.setupPortalNode();\n\t\t}\n\n\t\tif (this.props.portalMount) {\n\t\t\tthis.props.portalMount({\n\t\t\t\tinstance: this,\n\t\t\t\treactElement: this.getChildren(),\n\t\t\t\tdomContainerNode: this.portalNode,\n\t\t\t\tupdateCallback: () => {\n\t\t\t\t\tthis.updatePortal(); // update after subtree renders\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\t// actual render\n\t\t\tReactDOM.unstable_renderSubtreeIntoContainer(\n\t\t\t\tthis,\n\t\t\t\tthis.getChildren(),\n\t\t\t\tthis.portalNode,\n\t\t\t\t() => {\n\t\t\t\t\tthis.updatePortal(); // update after subtree renders\n\n\t\t\t\t\tif (this.state.isOpen === false) {\n\t\t\t\t\t\tif (this.props.onOpen) {\n\t\t\t\t\t\t\tthis.props.onOpen(undefined, { portal: this.getChildren() });\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setState({ isOpen: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\trender () {\n\t\treturn null;\n\t}\n}\n\nPortal.displayName = 'Portal';\n\nPortal.propTypes = {\n\t/*\n\t * What tag to use for the portal, defaults to `div`.\n\t */\n\trenderTag: PropTypes.string,\n\t/*\n\t * What node the portal is rendered to, defaults to `document.body`.\n\t */\n\trenderTo: PropTypes.any,\n\t/*\n\t * React id prop.\n\t */\n\tid: PropTypes.string,\n\t/*\n\t * Accepts a _single_ element or component.\n\t */\n\tchildren: PropTypes.node,\n\t/*\n\t * ClassName added to .\n\t */\n\tclassName: PropTypes.any,\n\t/*\n\t * An object of styles that are applied to the portal.\n\t */\n\tstyle: PropTypes.object,\n\t/*\n\t * Triggers when Portal render tree mounts. Pass in an undefined event and `{ portal: [node] }``\n\t */\n\tonMount: PropTypes.func,\n\t/*\n\t * Triggers when the portal is mounted.\n\t */\n\tonOpen: PropTypes.func,\n\t/*\n\t * Triggers when Portal re-renders its tree.\n\t */\n\tonUpdate: PropTypes.func,\n\t/*\n\t * Triggers when Portal render tree unmounts.\n\t */\n\tonUnmount: PropTypes.func,\n\t/**\n\t * If a dialog is `positione=\"overflowBoundaryElement\"`, it will be rendered in a portal or separate render tree. This `portalMount` callback will be triggered instead of the the default `ReactDOM.unstable_renderSubtreeIntoContainer` and the function will mount the portal itself. Consider the following code that bypasses the internal mount and uses an Enzyme wrapper to mount the React root tree to the DOM.\n\t *\n\t * ```\n\t * <Popover\n\t *   isOpen\n\t *   portalMount={({ instance, reactElement, domContainerNode }) => {\n\t *     portalWrapper = Enzyme.mount(reactElement, { attachTo: domContainerNode });\n\t *   }}\n\t *   onOpen={() => {\n\t *     expect(portalWrapper.find(`#my-heading`)).to.exist;\n\t *     done();\n\t *   }}\n\t * />\n\t * ```\n\t */\n\tportalMount: PropTypes.func,\n};\n\nPortal.defaultProps = {\n\trenderTag: 'span',\n\trenderTo: null,\n\tonMount: () => null,\n\tonOpen: () => null,\n\tonUpdate: () => null,\n\tonUnmount: () => null,\n};\n\nexport default Portal;\n"],"file":"portal.js"}